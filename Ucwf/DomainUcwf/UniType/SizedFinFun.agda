{-# OPTIONS --safe --sized-types #-}

module Ucwf.DomainUcwf.UniType.SizedFinFun where

open import Base.Core
open import Ucwf.DomainUcwf.UniType.Definition

open import Agda.Builtin.Size
open import Agda.Primitive

private
  variable
    ğ‘“ ğ‘“â€² ğ‘“â€³ ğ‘“â€´ : FinFunâ‚›

data _âˆˆâ‚›_ : {i : Size} â†’ Ã—â‚› {i} â†’ FinFunâ‚› {i} â†’ Set where
  here : {i : Size} â†’ {x : Ã—â‚› {i}} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
         x âˆˆâ‚› (x âˆ· ğ‘“)
  there : {i : Size} â†’ {x x' : Ã—â‚› {i}} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
          x âˆˆâ‚› ğ‘“ â†’ x âˆˆâ‚› (x' âˆ· ğ‘“)

_âŠ†â‚›_ : {i : Size} â†’ FinFunâ‚› {i} â†’ FinFunâ‚› {i} â†’ Set
_âŠ†â‚›_ {i} ğ‘“ ğ‘“â€² = âˆ€ x â†’ _âˆˆâ‚›_ {i} x ğ‘“ â†’ _âˆˆâ‚›_ {i} x ğ‘“â€²

âŠ†â‚›-refl : {i : Size} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’ ğ‘“ âŠ†â‚› ğ‘“
âŠ†â‚›-refl x xâˆˆğ‘“ = xâˆˆğ‘“

âŠ†â‚›-trans : {i : Size} â†’ {ğ‘“ ğ‘“â€² ğ‘“â€³ : FinFunâ‚› {i}} â†’ ğ‘“ âŠ†â‚› ğ‘“â€² â†’
           ğ‘“â€² âŠ†â‚› ğ‘“â€³ â†’ ğ‘“ âŠ†â‚› ğ‘“â€³
âŠ†â‚›-trans ğ‘“âŠ†ğ‘“â€² ğ‘“â€²âŠ†ğ‘“â€³ x xâˆˆğ‘“ = ğ‘“â€²âŠ†ğ‘“â€³ x (ğ‘“âŠ†ğ‘“â€² x xâˆˆğ‘“)

âŠ†â‚›-lemmaâ‚ƒ : {i : Size} â†’ âˆ€ {x} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
            ğ‘“ âŠ†â‚› (x âˆ· ğ‘“)
âŠ†â‚›-lemmaâ‚ƒ y yâˆˆğ‘“ = there yâˆˆğ‘“

âŠ†â‚›-lemmaâ‚„ : âˆ€ {x} â†’ x âˆˆâ‚› ğ‘“ â†’ ğ‘“â€² âŠ†â‚› ğ‘“ â†’ (x âˆ· ğ‘“â€²) âŠ†â‚› ğ‘“
âŠ†â‚›-lemmaâ‚„ xâˆˆğ‘“ _ _ here = xâˆˆğ‘“
âŠ†â‚›-lemmaâ‚„ xâˆˆğ‘“ ğ‘“â€²âŠ†ğ‘“ y (there yâˆˆğ‘“) = ğ‘“â€²âŠ†ğ‘“ y yâˆˆğ‘“

âˆ…-isSubsetâ‚› : {i : Size} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’ âˆ… âŠ†â‚› ğ‘“
âˆ…-isSubsetâ‚› x ()

âˆªâ‚›-lemmaâ‚ : {i : Size} â†’ {ğ‘“ ğ‘“â€² ğ‘“â€³ : FinFunâ‚› {i}} â†’
            ğ‘“ âŠ†â‚› ğ‘“â€³ â†’ ğ‘“â€² âŠ†â‚› ğ‘“â€³ â†’ (ğ‘“ âˆªâ‚› ğ‘“â€²) âŠ†â‚› ğ‘“â€³
âˆªâ‚›-lemmaâ‚ {ğ‘“ = âˆ…} _ ğ‘“â€²âŠ†ğ‘“â€³ y yâˆˆğ‘“âˆªğ‘“â€² = ğ‘“â€²âŠ†ğ‘“â€³ y yâˆˆğ‘“âˆªğ‘“â€²
âˆªâ‚›-lemmaâ‚ {ğ‘“ = x âˆ· _} ğ‘“âŠ†ğ‘“â€³ _ _ here = ğ‘“âŠ†ğ‘“â€³ x here
âˆªâ‚›-lemmaâ‚ {ğ‘“ = x âˆ· ğ‘“â€´} ğ‘“âŠ†ğ‘“â€³ ğ‘“â€²âŠ†ğ‘“â€³ y (there yâˆˆğ‘“âˆªğ‘“â€²)
  = âˆªâ‚›-lemmaâ‚ (âŠ†â‚›-trans âŠ†â‚›-lemmaâ‚ƒ ğ‘“âŠ†ğ‘“â€³) ğ‘“â€²âŠ†ğ‘“â€³ y yâˆˆğ‘“âˆªğ‘“â€²

âˆªâ‚›-lemmaâ‚‚ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ x â†’
            x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²) â†’ (x âˆˆâ‚› ğ‘“) âˆ¨ (x âˆˆâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = âˆ…} _ here = inr here
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = âˆ…} _ (there xâˆˆxs) = inr (there xâˆˆxs)
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = x âˆ· _} _ here = inl here
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = x âˆ· ğ‘“â€³} y (there yâˆˆâˆª)
  with (âˆªâ‚›-lemmaâ‚‚ y yâˆˆâˆª)
âˆªâ‚›-lemmaâ‚‚ y (there yâˆˆâˆª) | inl yâˆˆğ‘“â€³ = inl (there yâˆˆğ‘“â€³)
âˆªâ‚›-lemmaâ‚‚ y (there yâˆˆâˆª) | inr yâˆˆğ‘“â€² = inr yâˆˆğ‘“â€²

âˆªâ‚›-lemmaâ‚ƒ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ x â†’
            x âˆˆâ‚› ğ‘“ â†’ x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚ƒ {ğ‘“ = x âˆ· ğ‘“â€³} _ here = here
âˆªâ‚›-lemmaâ‚ƒ {ğ‘“ = x âˆ· ğ‘“â€³} y (there yâˆˆğ‘“â€³) = âŠ†â‚›-lemmaâ‚ƒ y yâˆˆğ‘“â€³âˆªğ‘“â€²
  where yâˆˆğ‘“â€³âˆªğ‘“â€² = âˆªâ‚›-lemmaâ‚ƒ y yâˆˆğ‘“â€³

âˆªâ‚›-lemmaâ‚„ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ x â†’
            x âˆˆâ‚› ğ‘“â€² â†’ x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚„ {ğ‘“ = âˆ…} x xâˆˆğ‘“â€² = xâˆˆğ‘“â€²
âˆªâ‚›-lemmaâ‚„ {ğ‘“ = x âˆ· ğ‘“â€³} y yâˆˆğ‘“â€² = âŠ†â‚›-lemmaâ‚ƒ y yâˆˆğ‘“â€³âˆªğ‘“â€²
  where yâˆˆğ‘“â€³âˆªğ‘“â€² = âˆªâ‚›-lemmaâ‚„ y yâˆˆğ‘“â€²

âˆªâ‚›-lemmaâ‚… : ğ‘“ âŠ†â‚› ğ‘“â€³ â†’ ğ‘“â€² âŠ†â‚› ğ‘“â€´ â†’ (ğ‘“ âˆªâ‚› ğ‘“â€²) âŠ†â‚› (ğ‘“â€³ âˆªâ‚› ğ‘“â€´)
âˆªâ‚›-lemmaâ‚… _ _ x xâˆˆğ‘“âˆªğ‘“â€² with (âˆªâ‚›-lemmaâ‚‚ x xâˆˆğ‘“âˆªğ‘“â€²)
âˆªâ‚›-lemmaâ‚… ğ‘“âŠ†ğ‘“â€³ _ x _ | inl xâˆˆğ‘“ = âˆªâ‚›-lemmaâ‚ƒ x (ğ‘“âŠ†ğ‘“â€³ x xâˆˆğ‘“)
âˆªâ‚›-lemmaâ‚… _ ğ‘“â€²âŠ†ğ‘“â€´ x _ | inr xâˆˆğ‘“â€² = âˆªâ‚›-lemmaâ‚„ x (ğ‘“â€²âŠ†ğ‘“â€´ x xâˆˆğ‘“â€²)

-- From a proof that a pair of neighborhoods is
-- in the empty set, anything.
xyâˆˆâˆ…-abs : {p : Set} â†’ âˆ€ {x y} â†’ < x , y >â‚› âˆˆâ‚› âˆ… â†’ p
xyâˆˆâˆ…-abs ()

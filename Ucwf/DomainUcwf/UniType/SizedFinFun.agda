{-# OPTIONS --safe --sized-types #-}

module Ucwf.DomainUcwf.UniType.SizedFinFun where

open import Base.Core hiding (_,_)
open import Ucwf.DomainUcwf.UniType.Definition

open import Agda.Builtin.Size
open import Agda.Primitive

private
  variable
    ğ‘“ ğ‘“â€² ğ‘“â€³ ğ‘“â€´ : FinFunâ‚›

data _âˆˆâ‚›_ : {i : Size} â†’ Ã—â‚› {i} â†’ FinFunâ‚› {i} â†’ Set where
  here : {i : Size} â†’ {x : Ã—â‚› {i}} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
         x âˆˆâ‚› (x âˆ· ğ‘“)
  there : {i : Size} â†’ {x x' : Ã—â‚› {i}} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
          x âˆˆâ‚› ğ‘“ â†’ x âˆˆâ‚› (x' âˆ· ğ‘“)

_âŠ†â‚›_ : {i : Size} â†’ FinFunâ‚› {i} â†’ FinFunâ‚› {i} â†’ Set
_âŠ†â‚›_ {i} ğ‘“ ğ‘“â€² = âˆ€ {x} â†’ _âˆˆâ‚›_ {i} x ğ‘“ â†’ _âˆˆâ‚›_ {i} x ğ‘“â€²

âŠ†â‚›-refl : {i : Size} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’ ğ‘“ âŠ†â‚› ğ‘“
âŠ†â‚›-refl xâˆˆğ‘“ = xâˆˆğ‘“

âŠ†â‚›-trans : {i : Size} â†’ {ğ‘“ ğ‘“â€² ğ‘“â€³ : FinFunâ‚› {i}} â†’ ğ‘“ âŠ†â‚› ğ‘“â€² â†’
           ğ‘“â€² âŠ†â‚› ğ‘“â€³ â†’ ğ‘“ âŠ†â‚› ğ‘“â€³
âŠ†â‚›-trans ğ‘“âŠ†ğ‘“â€² ğ‘“â€²âŠ†ğ‘“â€³ xâˆˆğ‘“ = ğ‘“â€²âŠ†ğ‘“â€³ (ğ‘“âŠ†ğ‘“â€² xâˆˆğ‘“)

âŠ†â‚›-lemmaâ‚ƒ : {i : Size} â†’ âˆ€ {x} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’
            ğ‘“ âŠ†â‚› (x âˆ· ğ‘“)
âŠ†â‚›-lemmaâ‚ƒ yâˆˆğ‘“ = there yâˆˆğ‘“

âŠ†â‚›-lemmaâ‚„ : âˆ€ {x} â†’ x âˆˆâ‚› ğ‘“ â†’ ğ‘“â€² âŠ†â‚› ğ‘“ â†’ (x âˆ· ğ‘“â€²) âŠ†â‚› ğ‘“
âŠ†â‚›-lemmaâ‚„ xâˆˆğ‘“ _ here = xâˆˆğ‘“
âŠ†â‚›-lemmaâ‚„ xâˆˆğ‘“ ğ‘“â€²âŠ†ğ‘“ (there yâˆˆğ‘“) = ğ‘“â€²âŠ†ğ‘“ yâˆˆğ‘“

âˆ…-isSubsetâ‚› : {i : Size} â†’ {ğ‘“ : FinFunâ‚› {i}} â†’ âˆ… âŠ†â‚› ğ‘“
âˆ…-isSubsetâ‚› ()

âˆªâ‚›-lemmaâ‚ : {i : Size} â†’ {ğ‘“ ğ‘“â€² ğ‘“â€³ : FinFunâ‚› {i}} â†’
            ğ‘“ âŠ†â‚› ğ‘“â€³ â†’ ğ‘“â€² âŠ†â‚› ğ‘“â€³ â†’ (ğ‘“ âˆªâ‚› ğ‘“â€²) âŠ†â‚› ğ‘“â€³
âˆªâ‚›-lemmaâ‚ {ğ‘“ = âˆ…} _ ğ‘“â€²âŠ†ğ‘“â€³ yâˆˆğ‘“âˆªğ‘“â€² = ğ‘“â€²âŠ†ğ‘“â€³ yâˆˆğ‘“âˆªğ‘“â€²
âˆªâ‚›-lemmaâ‚ {ğ‘“ = x âˆ· _} ğ‘“âŠ†ğ‘“â€³ _ here = ğ‘“âŠ†ğ‘“â€³ here
âˆªâ‚›-lemmaâ‚ {ğ‘“ = x âˆ· ğ‘“â€´} ğ‘“âŠ†ğ‘“â€³ ğ‘“â€²âŠ†ğ‘“â€³ (there yâˆˆğ‘“âˆªğ‘“â€²)
  = âˆªâ‚›-lemmaâ‚ (âŠ†â‚›-trans âŠ†â‚›-lemmaâ‚ƒ ğ‘“âŠ†ğ‘“â€³) ğ‘“â€²âŠ†ğ‘“â€³ yâˆˆğ‘“âˆªğ‘“â€²

âˆªâ‚›-lemmaâ‚‚ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ {x} â†’
            x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²) â†’ (x âˆˆâ‚› ğ‘“) âˆ¨ (x âˆˆâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = âˆ…} here = inr here
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = âˆ…} (there xâˆˆxs) = inr (there xâˆˆxs)
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = x âˆ· _} here = inl here
âˆªâ‚›-lemmaâ‚‚ {ğ‘“ = x âˆ· ğ‘“â€³} (there yâˆˆâˆª)
  with (âˆªâ‚›-lemmaâ‚‚ yâˆˆâˆª)
âˆªâ‚›-lemmaâ‚‚ (there yâˆˆâˆª) | inl yâˆˆğ‘“â€³ = inl (there yâˆˆğ‘“â€³)
âˆªâ‚›-lemmaâ‚‚ (there yâˆˆâˆª) | inr yâˆˆğ‘“â€² = inr yâˆˆğ‘“â€²

âˆªâ‚›-lemmaâ‚ƒ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ {x} â†’
            x âˆˆâ‚› ğ‘“ â†’ x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚ƒ {ğ‘“ = x âˆ· ğ‘“â€³} here = here
âˆªâ‚›-lemmaâ‚ƒ {ğ‘“ = x âˆ· ğ‘“â€³} (there yâˆˆğ‘“â€³) = âŠ†â‚›-lemmaâ‚ƒ yâˆˆğ‘“â€³âˆªğ‘“â€²
  where yâˆˆğ‘“â€³âˆªğ‘“â€² = âˆªâ‚›-lemmaâ‚ƒ yâˆˆğ‘“â€³

âˆªâ‚›-lemmaâ‚„ : {i : Size} â†’ {ğ‘“ ğ‘“â€² : FinFunâ‚› {i}} â†’ âˆ€ {x} â†’
            x âˆˆâ‚› ğ‘“â€² â†’ x âˆˆâ‚› (ğ‘“ âˆªâ‚› ğ‘“â€²)
âˆªâ‚›-lemmaâ‚„ {ğ‘“ = âˆ…} xâˆˆğ‘“â€² = xâˆˆğ‘“â€²
âˆªâ‚›-lemmaâ‚„ {ğ‘“ = x âˆ· ğ‘“â€³} yâˆˆğ‘“â€² = âŠ†â‚›-lemmaâ‚ƒ yâˆˆğ‘“â€³âˆªğ‘“â€²
  where yâˆˆğ‘“â€³âˆªğ‘“â€² = âˆªâ‚›-lemmaâ‚„ yâˆˆğ‘“â€²

âˆªâ‚›-lemmaâ‚… : ğ‘“ âŠ†â‚› ğ‘“â€³ â†’ ğ‘“â€² âŠ†â‚› ğ‘“â€´ â†’ (ğ‘“ âˆªâ‚› ğ‘“â€²) âŠ†â‚› (ğ‘“â€³ âˆªâ‚› ğ‘“â€´)
âˆªâ‚›-lemmaâ‚… _ _ xâˆˆğ‘“âˆªğ‘“â€² with (âˆªâ‚›-lemmaâ‚‚ xâˆˆğ‘“âˆªğ‘“â€²)
âˆªâ‚›-lemmaâ‚… ğ‘“âŠ†ğ‘“â€³ _ _ | inl xâˆˆğ‘“ = âˆªâ‚›-lemmaâ‚ƒ (ğ‘“âŠ†ğ‘“â€³ xâˆˆğ‘“)
âˆªâ‚›-lemmaâ‚… _ ğ‘“â€²âŠ†ğ‘“â€´ _ | inr xâˆˆğ‘“â€² = âˆªâ‚›-lemmaâ‚„ (ğ‘“â€²âŠ†ğ‘“â€´ xâˆˆğ‘“â€²)

-- From a proof that a pair of neighborhoods is
-- in the empty set, anything.
xyâˆˆâˆ…-abs : {p : Set} â†’ âˆ€ {x y} â†’ (x , y) âˆˆâ‚› âˆ… â†’ p
xyâˆˆâˆ…-abs ()

{-# OPTIONS --safe #-}

module Scwf.DomainScwf.Appmap.Valuation.AxiomProofs where

open import Base.Core
open import Base.Variables
open import NbhSys.Definition
open import Scwf.DomainScwf.Appmap.Valuation.Definition
open import Scwf.DomainScwf.Appmap.Valuation.Relation

Con-โแตฅ : โ {๐ฅ ๐ฆ ๐ง} โ โแตฅ ฮ ๐ฅ ๐ง โ โแตฅ ฮ ๐ฆ ๐ง โ ValCon ฮ ๐ฅ ๐ฆ
Con-โแตฅ โแตฅ-nil โแตฅ-nil = con-nil
Con-โแตฅ {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ} {โช y , ๐ฆ โซ} {โช z , ๐ง โซ}
  (โแตฅ-cons _ _ _ xโz ๐ฅโ๐ง) (โแตฅ-cons _ _ _ yโz ๐ฆโ๐ง)
  = con-tup conxy con๐ฅ๐ฆ
  where conxy = NbhSys.Con-โ ๐ด xโz yโz
        con๐ฅ๐ฆ = Con-โแตฅ ๐ฅโ๐ง ๐ฆโ๐ง

โแตฅ-refl : โ {๐ฅ} โ โแตฅ ฮ ๐ฅ ๐ฅ
โแตฅ-refl {๐ฅ = โชโซ}= โแตฅ-nil
โแตฅ-refl {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ}
  = โแตฅ-cons (๐ด :: ฮ) โช x , ๐ฅ โซ โช x , ๐ฅ โซ
    (NbhSys.โ-refl ๐ด) โแตฅ-refl

โแตฅ-trans : โ {๐ฅ ๐ฆ ๐ง} โ โแตฅ ฮ ๐ฅ ๐ฆ โ โแตฅ ฮ ๐ฆ ๐ง โ โแตฅ ฮ ๐ฅ ๐ง
โแตฅ-trans {๐ฅ = โชโซ} {โชโซ} {โชโซ} _ _ = โแตฅ-nil
โแตฅ-trans {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ}
  {โช y , ๐ฆ โซ} {โช z , ๐ง โซ}
  (โแตฅ-cons _ _ _ xโy ๐ฅโ๐ฆ)
  (โแตฅ-cons _ _ _ yโz ๐ฆโ๐ง)
  = โแตฅ-cons (๐ด :: ฮ) โช x , ๐ฅ โซ โช z , ๐ง โซ
    (NbhSys.โ-trans ๐ด xโy yโz) (โแตฅ-trans ๐ฅโ๐ฆ ๐ฆโ๐ง)

โแตฅ-โฅ : โ {๐ฅ} โ โแตฅ ฮ โฅแตฅ ๐ฅ
โแตฅ-โฅ {๐ฅ = โชโซ} = โแตฅ-nil
โแตฅ-โฅ {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ}
  = โแตฅ-cons (๐ด :: ฮ) โช NbhSys.โฅ ๐ด , โฅแตฅ โซ โช x , ๐ฅ โซ
    (NbhSys.โ-โฅ ๐ด) (โแตฅ-โฅ)

โแตฅ-โ : โ {๐ฅ ๐ฆ ๐ง} โ โแตฅ ฮ ๐ฆ ๐ฅ โ โแตฅ ฮ ๐ง ๐ฅ โ (con : ValCon ฮ ๐ฆ ๐ง) โ
       โแตฅ ฮ (๐ฆ โแตฅ ๐ง [ con ]) ๐ฅ
โแตฅ-โ {๐ฅ = โชโซ} {โชโซ} {โชโซ} _ _ _ = โแตฅ-nil
โแตฅ-โ {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ} {โช y , ๐ฆ โซ} {โช z , ๐ง โซ}
  (โแตฅ-cons _ _ _ yโx ๐ฆโ๐ฅ) (โแตฅ-cons _ _ _ zโx ๐งโ๐ฅ)
  (con-tup conyz con๐ฆ๐ง) =
  โแตฅ-cons (๐ด :: ฮ) (โช y , ๐ฆ โซ โแตฅ โช z , ๐ง โซ
  [ con-tup conyz con๐ฆ๐ง ]) โช x , ๐ฅ โซ
  yโzโx (โแตฅ-โ ๐ฆโ๐ฅ ๐งโ๐ฅ con๐ฆ๐ง)
  where yโzโx = NbhSys.โ-โ ๐ด yโx zโx conyz

โแตฅ-โ-fst : โ {๐ฅ ๐ฆ} โ (con : ValCon ฮ ๐ฅ ๐ฆ) โ โแตฅ ฮ ๐ฅ (๐ฅ โแตฅ ๐ฆ [ con ])
โแตฅ-โ-fst {๐ฅ = โชโซ} {โชโซ} _ = โแตฅ-nil
โแตฅ-โ-fst {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ} {โช y , ๐ฆ โซ}
  (con-tup conxy con๐ฅ๐ฆ)
  = โแตฅ-cons (๐ด :: ฮ) โช x , ๐ฅ โซ (โช x , ๐ฅ โซ โแตฅ โช y , ๐ฆ โซ
    [ con-tup conxy con๐ฅ๐ฆ ])
    (NbhSys.โ-โ-fst ๐ด conxy) (โแตฅ-โ-fst con๐ฅ๐ฆ)

โแตฅ-โ-snd : โ {๐ฅ ๐ฆ} โ  (con : ValCon ฮ ๐ฅ ๐ฆ) โ โแตฅ ฮ ๐ฆ (๐ฅ โแตฅ ๐ฆ [ con ])
โแตฅ-โ-snd {๐ฅ = โชโซ} {โชโซ} _ = โแตฅ-nil
โแตฅ-โ-snd {ฮ = ๐ด :: ฮ} {๐ฅ = โช x , ๐ฅ โซ} {โช y , ๐ฆ โซ}
  (con-tup conxy con๐ฅ๐ฆ)
  = โแตฅ-cons (๐ด :: ฮ) โช y , ๐ฆ โซ (โช x , ๐ฅ โซ โแตฅ โช y , ๐ฆ โซ
    [ con-tup conxy con๐ฅ๐ฆ ])
    (NbhSys.โ-โ-snd ๐ด conxy) (โแตฅ-โ-snd con๐ฅ๐ฆ)

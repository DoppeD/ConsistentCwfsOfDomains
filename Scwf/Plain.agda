{-# OPTIONS --safe #-}

module Scwf.Plain where

open import Base.Core using (Rel ; IsEquivalence)
open import Base.Variables

open import Agda.Builtin.Nat

record Scwf : Setâ‚‚ where
  field
    Ty : Setâ‚
    Ctx : Nat â†’ Setâ‚
    Tm : Ctx n â†’ Ty â†’ Setâ‚
    Sub : Ctx m â†’ Ctx n â†’ Setâ‚

    _â‰ˆ_ : âˆ€ {Î“ ğ´} â†’ Rel (Tm {n} Î“ ğ´)
    _â‰Š_ : âˆ€ {Î“ Î”} â†’ Rel (Sub {m} {n} Î“ Î”)

    isEquivT : âˆ€ {Î“ ğ´} â†’ IsEquivalence (_â‰ˆ_ {n} {Î“} {ğ´})
    isEquivS : âˆ€ {Î“ Î”} â†’ IsEquivalence (_â‰Š_ {m} {n} {Î“} {Î”})

    â—‡ : Ctx zero

    _â€¢_ : Ctx n â†’ Ty â†’ Ctx (suc n)

    q : (Î“ : Ctx n) â†’ (ğ´ : Ty) â†’ Tm (Î“ â€¢ ğ´) ğ´
    _[_] : âˆ€ {ğ´ Î“ Î”} â†’ Tm {n} Î” ğ´ â†’ Sub {m} Î“ Î” â†’ Tm Î“ ğ´

    id : (Î“ : Ctx n) â†’ Sub Î“ Î“
    _âˆ˜_ : âˆ€ {Î“ Î” Î˜} â†’ Sub {n} {o} Î” Î˜ â†’ Sub {m} Î“ Î” â†’ Sub Î“ Î˜
    âŸ¨âŸ© : {Î“ : Ctx n} â†’ Sub Î“ â—‡
    âŸ¨_,_âŸ© : âˆ€ {Î“ Î” ğ´} â†’ Sub {n} {m} Î” Î“ â†’ Tm Î” ğ´ â†’ Sub Î” (Î“ â€¢ ğ´)
    p : (Î“ : Ctx n) â†’ (ğ´ : Ty) â†’ Sub (Î“ â€¢ ğ´) Î“

    idL : âˆ€ {Î“ Î”} â†’ (Î³ : Sub {n} {m} Î” Î“) â†’ ((id Î“) âˆ˜ Î³) â‰Š Î³
    idR : âˆ€ {Î“ Î”} â†’ (Î³ : Sub {n} {m} Î” Î“) â†’ (Î³ âˆ˜ (id Î”)) â‰Š Î³
    subAssoc : âˆ€ {Î“ Î” Î˜ Î›} â†’ (Î³ : Sub {m} {n} Î“ Î”) â†’
               (Î´ : Sub {n} {o} Î” Î˜) â†’ (Î¸ : Sub {o} {r} Î˜ Î›) â†’
               ((Î¸ âˆ˜ Î´) âˆ˜ Î³) â‰Š (Î¸ âˆ˜ (Î´ âˆ˜ Î³))

    idSub : âˆ€ {Î“ ğ´} â†’ (ğ‘¡ : Tm {n} Î“ ğ´) â†’ (ğ‘¡ [ id Î“ ]) â‰ˆ ğ‘¡
    compSub : âˆ€ {Î“ Î” Î˜ ğ´} â†’ (ğ‘¡ : Tm {n} Î” ğ´) â†’
              (Î³ : Sub {m} Î“ Î”) â†’ (Î´ : Sub {o} Î˜ Î“) â†’
              (ğ‘¡ [ Î³ âˆ˜ Î´ ]) â‰ˆ ((ğ‘¡ [ Î³ ]) [ Î´ ])

    idâ‚€ : id â—‡ â‰Š âŸ¨âŸ©
    <>-zero : âˆ€ {Î“ Î”} â†’ (Î³ : Sub {m} {n} Î“ Î”) â†’ (âŸ¨âŸ© âˆ˜ Î³) â‰Š âŸ¨âŸ©

    pCons : âˆ€ {ğ´ Î“ Î”} â†’ (Î³ : Sub {n} {m} Î” Î“) â†’ (ğ‘¡ : Tm Î” ğ´) â†’
            ((p Î“ ğ´) âˆ˜ âŸ¨ Î³ , ğ‘¡ âŸ©) â‰Š Î³
    qCons : âˆ€ {ğ´ Î“ Î”} â†’ (Î³ : Sub {n} {m} Î” Î“) â†’ (ğ‘¡ : Tm Î” ğ´) â†’
            ((q Î“ ğ´) [ âŸ¨ Î³ , ğ‘¡ âŸ© ]) â‰ˆ ğ‘¡
    idExt : âˆ€ {ğ´ Î“} â†’ (id (_â€¢_ {m} Î“ ğ´)) â‰Š âŸ¨ p Î“ ğ´ , q Î“ ğ´ âŸ©
    compExt : âˆ€ {Î“ Î” ğ´} â†’ (ğ‘¡ : Tm Î” ğ´) â†’
              (Î³ : Sub {n} {m} Î” Î“) â†’ (Î´ : Sub Î“ Î”) â†’
              (âŸ¨ Î³ , ğ‘¡ âŸ© âˆ˜ Î´) â‰Š âŸ¨ Î³ âˆ˜ Î´ , ğ‘¡ [ Î´ ] âŸ©

    subCong : âˆ€ {ğ´ Î“ Î”} â†’ {ğ‘¡ ğ‘¡â€² : Tm {m} Î“ ğ´} â†’
              {Î³ Î³â€² : Sub {n} Î” Î“} â†’ ğ‘¡ â‰ˆ ğ‘¡â€² â†’
              Î³ â‰Š Î³â€² â†’ (ğ‘¡ [ Î³ ]) â‰ˆ (ğ‘¡â€² [ Î³â€² ])
    <,>-cong : âˆ€ {ğ´ Î“ Î”} â†’ {ğ‘¡ ğ‘¡â€² : Tm {m} Î“ ğ´} â†’
               {Î³ Î³â€² : Sub {m} {n} Î“ Î”} â†’ ğ‘¡ â‰ˆ ğ‘¡â€² â†’
               Î³ â‰Š Î³â€² â†’ âŸ¨ Î³ , ğ‘¡ âŸ© â‰Š âŸ¨ Î³â€² , ğ‘¡â€² âŸ©
    âˆ˜-cong : âˆ€ {Î“ Î” Î˜} â†’ {Î³ Î´ : Sub {n} {o} Î” Î˜} â†’
             {Î³â€² Î´â€² : Sub {m} Î“ Î”} â†’ Î³ â‰Š Î´ â†’
             Î³â€² â‰Š Î´â€² â†’ (Î³ âˆ˜ Î³â€²) â‰Š (Î´ âˆ˜ Î´â€²)
